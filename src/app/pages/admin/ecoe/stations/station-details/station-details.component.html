<nz-content *ngIf="pagQblocks">
  <nz-table #table
            [nzData]="pagQblocks['items']"
            [(nzPageIndex)]="page"
            [(nzPageSize)]="perPage"
            (nzPageIndexChange)="pageChange($event)"
            (nzPageSizeChange)="pageSizeChange($event)"
            [nzLoading]="loading"
            [nzFrontPagination]="false"
            [nzTotal]="totalItems"
            nzSize="small"
            nzShowSizeChanger
            nzShowPagination>
    <thead>
    <tr>
      <th [nzExpand]="true">
        <a (click)="getQlobks().finally()">
          <i nz-icon icon-25 type="reload" [nz-tooltip] [nzPlacement]="'bottom'" [nzTitle]="'REFRESH' | translate"></i>
        </a>
      </th>
      <th nzWidth="85px">{{"ORDER" | translate}}</th>
      <th nzWidth="300px">{{"NAME" | translate}}</th>
      <th nzWidth="300px">{{"PARENT_STATION" | translate}}</th>
      <th nzWidth="140px">{{"CHILD_STATIONS" | translate}}</th>
      <th nzWidth="240px">
        <nz-button-group class="margin-left">
          <button nz-button [nzType]="'primary'"
                  [nz-tooltip] [nzTitle]="'ADD_STATION' | translate"
                  > <!--(click)="showDrawer()"-->
            <i nz-icon [type]="'plus-circle'" nzTheme="twotone" icon-16></i>
          </button>
          <app-upload-and-parse (parserResult)="getQlobks().finally()"></app-upload-and-parse>
        </nz-button-group>
      </th>
    </tr>
    </thead>
    <tbody>
    <ng-template ngFor let-item [ngForOf]="table.data">
      <tr>
        <td>

        </td>

        <td>
          <ng-container *ngIf="!editCache[item.id].edit">
            {{item.order || "-"}}
          </ng-container>

          <ng-container *ngIf="editCache[item.id].edit">
            <nz-input-number [nzMin]="0" [nzSize]="'small'" [(ngModel)]="editCache[item.id].item.order"></nz-input-number>
          </ng-container>
        </td>

        <td [routerLink]="['./', item.id]">
          <ng-container *ngIf="!editCache[item.id].edit" >
            {{item.name}}
          </ng-container>

          <ng-container *ngIf="editCache[item.id].edit">
            <input type="text" nz-input [nzSize]="'small'" [(ngModel)]="editCache[item.id].item.name">
          </ng-container>
        </td>

        <td>
          <!--<ng-container *ngIf="!editCache[item.id].edit">
            <nz-tag *ngIf="item.parentStation?.name"
                    [nzColor]="shared.stringToColour(item.parentStation.name)">{{item.parentStation.name}}</nz-tag>
          </ng-container>-->

          <!--<ng-container *ngIf="editCache[item.id].edit">
            <nz-select style="width: 100%"
                       nzShowSearch
                       nzServerSearch
                       [nzMaxTagCount]="1"
                       [nzNotFoundContent]="('STATION_NOT_FOUND' | translate)"
                       nzAllowClear="true"
                       [(ngModel)]="editCache[item.id].item.parentStation"
                       [nzPlaceHolder]="('PARENT_PLACEHOLDER' | translate)"
                       nzFilterOption="true"
                       (nzOnSearch)="searchInSelect($event, editCache[item.id].item.name)"
            >
              &lt;!&ndash;<ng-container *ngFor="let pageOptions of selectOptions">&ndash;&gt;
              <nz-option *ngFor="let station of selectOptions['items']"  [nzLabel]="station.name" [nzValue]="station"> </nz-option>
              &lt;!&ndash;</ng-container>&ndash;&gt;
            </nz-select>
          </ng-container>-->
        </td>

        <td>{{item.childrenStations?.length}}</td>

        <td text-right>
          <app-action-buttons [isEditing]="editCache[item.id]?.edit"
                              [isNewItem]="editCache[item.id]?.new_item"
                              (startEdit)="startEdit(item,editCache[item.id].item.name)"
                              (delete)="deleteItem(item)"
                              (save)="updateItem(editCache[item.id].item)"
                              (cancelEdit)="cancelEdit(item)">
          </app-action-buttons>
        </td>
      </tr>
    </ng-template>
    </tbody>
  </nz-table>
</nz-content>
